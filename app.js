const bodyParser = require('body-parser');
var express = require('express');
const language = require('@google-cloud/language');
var app = express()
app.use(bodyParser.urlencoded({ extended: false }));
app.use(bodyParser.json());

// Instantiates a client
const client = new language.LanguageServiceClient({
	credentials: {
	  "type": "service_account",
	  "project_id": "lie-detector-221420",
	  "private_key_id": "4216707c6af1115515bf7b1c8525495d3b9173a7",
	  "private_key": "-----BEGIN PRIVATE KEY-----\nMIIEvAIBADANBgkqhkiG9w0BAQEFAASCBKYwggSiAgEAAoIBAQCMojEUTXhJw19i\noueSGn5rE352oKmkQ2of/UIqFBI9fCgCd6ZRLZ1lLG2E6sWtb4r4RmlLDg3/px8a\nGHU1Moy+2/bAadUszCmE1tiLnYoH1avMCwGWYS6SQSq9BUIK2YAQYEBQEEN2GJbY\n04ghQTpS+/zDv/FnHrhkch+kG9kn6EHkjlbfpRLetqLy8DY+HuTQBRzlSOtq/FN1\n2sO/88RESnm0epu5jW6NMExHk+nG+IGg+lOFYQ4DyEzjRrl1u+Mvw3QdC1hmWz5j\nLZLtYLtFuk/I+vUceDFOVlibdAykMyFbUmHm/vxLgdpOjteYB680pwdxh51uD+eI\nmIBqm/1rAgMBAAECggEALSn9Zw7GHbJP1MaKZgJ6LPsStxg7wtQfpexYrljJztMr\nqjcww4tJq+9LsM8Q8vUKhVdfg0odNsg+Fcxa/92fE8Bii0KxwnRCtTWmT5gldwSo\n6ptyRBAru66QAipJHmDhXuD6ZnwCnk+hSjsM0dk32OSyNU9UQJC+GQwJm1OSNt1H\nQ+9Sb7IpMya5cFuB61hPTcwmBWVfN5FhwlICrvBot2hIjWi0oONbG55WiAbHVvjz\nB0u15MbML++gLyVsD5vOl8WjOXx5har7p5L1X8KRUpiVdUfrpDVGrystVY8OUvmZ\nkYGi2djqFohLduvOoGyOwBWJyOlngKatmJHh2IGa2QKBgQC/KMpo0H4xSC3a3ykE\nQ/zXNVvzf04hCk5MprXKzUfOjQlFhZIM2Si0Uj1CNbFMG6hEtmDadaXBbxhsyZIr\nRp4jti18JWWKuN1ZVgDVgtjxe/QRCYO9Pv+ChpTIgLR98jRYfQ4UcdtwWP5uS5oP\nLsCbJ9sLpiB0B/kjlS+p+H6W/QKBgQC8VgZWNoFBZOi+EN8qZrMOOSFcdxnJhubQ\nFx4Au6f8lAFusTXRkpXXvRc8QEKLA4etlOaAH1QknZfBEyE4KkbelN19FJyuTpNl\nO7Qz48AHtZWj3Nj2jADBHfiPHD1WyugRuY49F5T7YbFpRa40epuo0ra5SuVZtebp\nhSTQ0lU2hwKBgGOKDAwUNQHYgfgsqCEOfgRaRq0+pyJRSYBkdtlJl5CYpDFNYkXK\ndoWfJULqzo3BARf2l+xpwow9G0zakYBzXzldTcYNexiHNsukGv8TCYCFeQu+Fple\nypHfHm5hhprmmhdR1xkSSJ/x11r7hxdM0wJ3+HnSYafJ1xOORamOOezJAoGANSlH\nIqDB/XaBZ90VUT+p/TLNIu+PfN4yWrybwHM36MjSWq901JI+76W1YFF3NwwpCStF\noRa2xpshUeOXdeYhGQUGPB9MVrthSar/o8H+2247LgTRzU4ZjGlsVuEOw2gE97Pb\n3YzBhe++h0ue77tIIvBPmZ/1e0woQPRPPw6P9RMCgYByTUukFBCYpBysON1Zke/J\no/deb1G0glNo5KfJYN/f0T7KwlAoIswPFScUjRBgTD89GY3dVUEUlr7PWRm3HP4D\nwfyWeyM7/RxK2kFuiOIQfOPdPJd+unQx94eK9tSSoV11by+d8OeSTRCjcobWGiDb\nJ3JuxKQUjLI8GC/+kTdPww==\n-----END PRIVATE KEY-----\n",
	  "client_email": "lie-detector@lie-detector-221420.iam.gserviceaccount.com",
	  "client_id": "112958941361835404566",
	  "auth_uri": "https://accounts.google.com/o/oauth2/auth",
	  "token_uri": "https://oauth2.googleapis.com/token",
	  "auth_provider_x509_cert_url": "https://www.googleapis.com/oauth2/v1/certs",
	  "client_x509_cert_url": "https://www.googleapis.com/robot/v1/metadata/x509/lie-detector%40lie-detector-221420.iam.gserviceaccount.com"
	}
});

// The text to analyze
const text = 'Mario A. Segale, a Seattle-area real estate developer who unwittingly lent his name to perhaps the most famous video game character in history — Nintendo’s Mario — died at a local hospital on Oct. 27. He was 84. Kim G. Brown, of the Marlatt Funeral Home in Kent, Wash., confirmed the death. The cause was not specified.    Starting in the 1950s, Mr. Segale built a small empire in construction and real estate in Tukwila, a suburb of Seattle. Around 1980 he rented a 60,000-square-foot warehouse to Nintendo, a Japanese video-game company, as it sought to expand to the American market.     In his book “Game Over: How Nintendo Conquered the World,” David Sheff wrote that a small company team had gathered in the warehouse one day and was struggling to come up with American names for the characters in the arcade game Donkey Kong. They were stuck on the character of a squat carpenter wearing a red cap when there was a knock on the door.     It was Mr. Segale, who had come to berate Minoru Arakawa, then the president of Nintendo of America, for being past due on the rent.     Mr. Arakawa was already under great pressure to succeed, and Mr. Segale “blasted him” in front of everyone, Mr. Sheff wrote. A flustered Mr. Arakawa vowed that Mr. Segale would get his money soon.     And as soon as he left, Mr. Sheff wrote, the team knew it had its name: “Super Mario!” Super Mario had only a supporting role in Donkey Kong, but by the 1990s he had become Nintendo’s beloved mascot and the star of one of the most popular video game franchises to date. (He also changed professions, from carpentry to plumbing, when he got his own game.) In a video published by Nintendo in 2015, the game designer Shigeru Miyamoto confirmed with simple nod of his head that Mr. Segale had inspired Mario’s name.     Mario Arnold Segale was born in Seattle on April 30, 1934, to Louis and Rina Segale. The funeral home’s online obituarydescribes him as the only child of Italian immigrant farmers. He started his company, M. A. Segale Inc., with a single dump truck, the obituary says. It became a major construction contractor in the Northwest. Mr. Segale also continued his parents’ practice of buying land around Tukwila, and he established a business park there in the early 1970s.     Mr. Segale sold the construction company in 1998 to concentrate on Segale Properties, the family’s real estate business. The company also owns commercial properties in Seattle and agricultural land, including a vineyard, in eastern Washington.     The family is famously averse to speaking with the press. A 2010 Seattle Times article about a planned mixed-use project noted that Mr. Segale and his son, Mark, had not spoken with reporters since the 1990s. (The family did not speak with The Seattle Times for that article, and did not return calls from The New York Times on Friday.) Along with his son, Mr. Segale is survived by his wife, Donna, whom he married in 1957; three daughters, Lisa Atkins, Tina Covey and Nita Johnson; and nine grandchildren.     His obituary acknowledged that Mr. Segale had been the inspiration for the name Super Mario but that he had “always ducked the notoriety and wanted to be known instead for what he accomplished in his life.” He did break his silence in 1993, shortly after the story of Mario’s naming was published in Mr. Sheff’s book. The Seattle Times asked Mr. Segale what he thought about his name being used in a game that was so hugely popular. “You might say I’m still waiting for my royalty checks,” he said.  Mario A. Segale, a Seattle-area real estate developer who unwittingly lent his name to perhaps the most famous video game character in history — Nintendo’s Mario — died at a local hospital on Oct. 27. He was 84. Kim G. Brown, of the Marlatt Funeral Home in Kent, Wash., confirmed the death. The cause was not specified.    Starting in the 1950s, Mr. Segale built a small empire in construction and real estate in Tukwila, a suburb of Seattle. Around 1980 he rented a 60,000-square-foot warehouse to Nintendo, a Japanese video-game company, as it sought to expand to the American market.     In his book “Game Over: How Nintendo Conquered the World,” David Sheff wrote that a small company team had gathered in the warehouse one day and was struggling to come up with American names for the characters in the arcade game Donkey Kong. They were stuck on the character of a squat carpenter wearing a red cap when there was a knock on the door.     It was Mr. Segale, who had come to berate Minoru Arakawa, then the president of Nintendo of America, for being past due on the rent.     Mr. Arakawa was already under great pressure to succeed, and Mr. Segale “blasted him” in front of everyone, Mr. Sheff wrote. A flustered Mr. Arakawa vowed that Mr. Segale would get his money soon.     And as soon as he left, Mr. Sheff wrote, the team knew it had its name: “Super Mario!” Super Mario had only a supporting role in Donkey Kong, but by the 1990s he had become Nintendo’s beloved mascot and the star of one of the most popular video game franchises to date. (He also changed professions, from carpentry to plumbing, when he got his own game.) In a video published by Nintendo in 2015, the game designer Shigeru Miyamoto confirmed with simple nod of his head that Mr. Segale had inspired Mario’s name.     Mario Arnold Segale was born in Seattle on April 30, 1934, to Louis and Rina Segale. The funeral home’s online obituarydescribes him as the only child of Italian immigrant farmers. He started his company, M. A. Segale Inc., with a single dump truck, the obituary says. It became a major construction contractor in the Northwest. Mr. Segale also continued his parents’ practice of buying land around Tukwila, and he established a business park there in the early 1970s.     Mr. Segale sold the construction company in 1998 to concentrate on Segale Properties, the family’s real estate business. The company also owns commercial properties in Seattle and agricultural land, including a vineyard, in eastern Washington.     The family is famously averse to speaking with the press. A 2010 Seattle Times article about a planned mixed-use project noted that Mr. Segale and his son, Mark, had not spoken with reporters since the 1990s. (The family did not speak with The Seattle Times for that article, and did not return calls from The New York Times on Friday.) Along with his son, Mr. Segale is survived by his wife, Donna, whom he married in 1957; three daughters, Lisa Atkins, Tina Covey and Nita Johnson; and nine grandchildren.     His obituary acknowledged that Mr. Segale had been the inspiration for the name Super Mario but that he had “always ducked the notoriety and wanted to be known instead for what he accomplished in his life.” He did break his silence in 1993, shortly after the story of Mario’s naming was published in Mr. Sheff’s book. The Seattle Times asked Mr. Segale what he thought about his name being used in a game that was so hugely popular. “You might say I’m still waiting for my royalty checks,” he said. Mario A. Segale, a Seattle-area real estate developer who unwittingly lent his name to perhaps the most famous video game character in history — Nintendo’s Mario — died at a local hospital on Oct. 27. He was 84. Kim G. Brown, of the Marlatt Funeral Home in Kent, Wash., confirmed the death. The cause was not specified.    Starting in the 1950s, Mr. Segale built a small empire in construction and real estate in Tukwila, a suburb of Seattle. Around 1980 he rented a 60,000-square-foot warehouse to Nintendo, a Japanese video-game company, as it sought to expand to the American market.     In his book “Game Over: How Nintendo Conquered the World,” David Sheff wrote that a small company team had gathered in the warehouse one day and was struggling to come up with American names for the characters in the arcade game Donkey Kong. They were stuck on the character of a squat carpenter wearing a red cap when there was a knock on the door.     It was Mr. Segale, who had come to berate Minoru Arakawa, then the president of Nintendo of America, for being past due on the rent.     Mr. Arakawa was already under great pressure to succeed, and Mr. Segale “blasted him” in front of everyone, Mr. Sheff wrote. A flustered Mr. Arakawa vowed that Mr. Segale would get his money soon.     And as soon as he left, Mr. Sheff wrote, the team knew it had its name: “Super Mario!” Super Mario had only a supporting role in Donkey Kong, but by the 1990s he had become Nintendo’s beloved mascot and the star of one of the most popular video game franchises to date. (He also changed professions, from carpentry to plumbing, when he got his own game.) In a video published by Nintendo in 2015, the game designer Shigeru Miyamoto confirmed with simple nod of his head that Mr. Segale had inspired Mario’s name.     Mario Arnold Segale was born in Seattle on April 30, 1934, to Louis and Rina Segale. The funeral home’s online obituarydescribes him as the only child of Italian immigrant farmers. He started his company, M. A. Segale Inc., with a single dump truck, the obituary says. It became a major construction contractor in the Northwest. Mr. Segale also continued his parents’ practice of buying land around Tukwila, and he established a business park there in the early 1970s.     Mr. Segale sold the construction company in 1998 to concentrate on Segale Properties, the family’s real estate business. The company also owns commercial properties in Seattle and agricultural land, including a vineyard, in eastern Washington.     The family is famously averse to speaking with the press. A 2010 Seattle Times article about a planned mixed-use project noted that Mr. Segale and his son, Mark, had not spoken with reporters since the 1990s. (The family did not speak with The Seattle Times for that article, and did not return calls from The New York Times on Friday.) Along with his son, Mr. Segale is survived by his wife, Donna, whom he married in 1957; three daughters, Lisa Atkins, Tina Covey and Nita Johnson; and nine grandchildren.     His obituary acknowledged that Mr. Segale had been the inspiration for the name Super Mario but that he had “always ducked the notoriety and wanted to be known instead for what he accomplished in his life.” He did break his silence in 1993, shortly after the story of Mario’s naming was published in Mr. Sheff’s book. The Seattle Times asked Mr. Segale what he thought about his name being used in a game that was so hugely popular. “You might say I’m still waiting for my royalty checks,” he said.';


   let senmag = {
       "status" :200,
       "mag" : ""
   }

const document = {
  content: text,
  type: 'PLAIN_TEXT',
};

// Detects the sentiment of the text



// respond with "hello world" when a GET request is made to the homepage
app.post('/', function (req, res) {
    client
        .analyzeSentiment({document: document})
        .then(results => {
            const sentiment = results[0].documentSentiment;
            console.log(req.body);
            console.log(`Text: ${text}`);
            console.log(`Sentiment score: ${sentiment.score}`);
            console.log(`Sentiment magnitude: ${sentiment.magnitude}`);

            senmag.mag = sentiment.magnitude
            res.send(senmag)
        })
        .catch(err => {
            console.error('ERROR:', err);
        });

    //res.send(senmag)

})

app.listen(3000, function(){
  console.log('Server Started on Port 3000...');
})

